useDynLib(cydar, .registration=TRUE, .fixes="cxx_")

import(BiocParallel, SummarizedExperiment, S4Vectors, methods)
importFrom("plotrix", color.scale)
importFrom("viridis", viridis)
importFrom("glmnet", glmnet)
importFrom("stats", coef, kmeans, median, quantile, lm.fit, approxfun, density, approx, lm)

importFrom("graphics", plot, points, lines, par, polygon)
importFrom("shiny", 
        column, fluidPage, fluidRow, pageWithSidebar, sidebarPanel, mainPanel, headerPanel, h4, hr,
        observeEvent, actionButton, textInput,
        plotOutput, renderPlot, renderTable, tableOutput,
        shinyApp, stopApp, runApp)

exportClasses(cyData)

exportMethods(nmarkers, 
    ncells,
    markerData, "markerData<-",
    medianIntensities, "medianIntensities<-",
    cellIntensities, "cellIntensities<-"
)

export(countCells,  
    expandRadius,
    normalizeBatch,
    plotCellLogFC,
    plotCellIntensity,
    intensityRanges,
    spatialFDR,
    pickBestMarkers,
    prepareCellData,
    neighborDistances,
    findFirstSphere,
    interpretSpheres,
    cyData
)

